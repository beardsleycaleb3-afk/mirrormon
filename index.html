<!DOCTYPE html><html lang=en><head><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><style>body{background:#111;margin:0;display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;overflow:hidden;user-select:none}#case{background:#c0c0c0;padding:12px 12px 40px;border-radius:6px 6px 24px 6px;box-shadow:inset -3px -3px 12px #000}#screen{border:2px solid #222;background:#000}#controls{margin-top:10px;width:300px;height:120px;position:relative}.btn,.dpad{position:absolute;background:#444;border:1px solid #222;color:#aaa;border-radius:50%;width:36px;height:36px;font-size:12px;text-align:center;line-height:36px;box-shadow:0 2px 0 #000}.btn:active,.dpad:active{transform:translateY(2px);box-shadow:none}#up{top:0;left:40px;border-radius:4px 4px 0 0}#down{top:70px;left:40px;border-radius:0 0 4px 4px}#left{top:35px;left:5px;border-radius:4px 0 0 4px}#right{top:35px;left:75px;border-radius:0 4px 4px 0}#a{top:20px;right:5px;background:#a33;color:#fff}#b{top:40px;right:50px;background:#a33;color:#fff}#st{bottom:5px;left:100px;width:60px;height:20px;border-radius:10px;line-height:20px;font-size:9px}</style></head><body><div id=case><div id=screen><canvas id=c width=320 height=288></canvas></div><div id=controls><div id=up class=dpad ontouchstart="k('u',1)" ontouchend="k('u',0)" onmousedown="k('u',1)" onmouseup="k('u',0)"></div><div id=down class=dpad ontouchstart="k('d',1)" ontouchend="k('d',0)" onmousedown="k('d',1)" onmouseup="k('d',0)"></div><div id=left class=dpad ontouchstart="k('l',1)" ontouchend="k('l',0)" onmousedown="k('l',1)" onmouseup="k('l',0)"></div><div id=right class=dpad ontouchstart="k('r',1)" ontouchend="k('r',0)" onmousedown="k('r',1)" onmouseup="k('r',0)"></div><button id=a class=btn ontouchstart="k('a',1)" ontouchend="k('a',0)" onmousedown="k('a',1)" onmouseup="k('a',0)">A</button><button id=b class=btn ontouchstart="k('b',1)" ontouchend="k('b',0)" onmousedown="k('b',1)" onmouseup="k('b',0)">B</button><div id=st ontouchstart="k('st',1)">START</div></div></div><script>const c=document.getElementById('c').getContext('2d'),W=320,H=288,S=16;let state="INTRO",text="",p={x:4,y:4,dir:0,step:0},keys={},curMap;const MAPS={ROOM:{w:8,h:8,d:[1,1,1,1,1,1,1,1,1,0,0,1,0,0,0,1,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],exits:[{x:3,y:1,to:"TOWN",tx:10,ty:4}]},TOWN:{w:20,h:16,d:Array(320).fill(0).map((v,i)=>i<20||i>300||i%20==0||i%20==19?1:Math.random()<.1?4:0),exits:[{x:4,y:6,to:"ROOM",tx:3,ty:2},{x:14,y:6,to:"LAB",tx:4,ty:7}]},LAB:{w:10,h:10,d:Array(100).fill(0).map((v,i)=>i<10||i>89||i%10==0||i%10==9?1:Math.random()<.2?5:0),exits:[{x:4,y:7,to:"TOWN",tx:14,ty:7}]}}curMap=MAPS.ROOM;function k(k,v){keys[k]=v;if(v&&k==='a'&&state==='INTRO')nextIntro();if(v&&k==='a'&&state==='LAB')checkLab();if(v&&k==='b'&&state==='BATTLE')useItem()}function loop(){update();draw();requestAnimationFrame(loop)}function update(){if(state==='INTRO')return;if(p.step>0){p.step-=.1;if(p.step<=0){p.step=0;if(p.dir==0)p.y--;if(p.dir==1)p.y++;if(p.dir==2)p.x--;if(p.dir==3)p.x++;checkTile()}}else{if(keys.u){p.dir=0;tryMove(0,-1)}else if(keys.d){p.dir=1;tryMove(0,1)}else if(keys.l){p.dir=2;tryMove(-1,0)}else if(keys.r){p.dir=3;tryMove(1,0)}}}function tryMove(dx,dy){let tx=p.x+dx,ty=p.y+dy;if(tx>=0&&tx<curMap.w&&ty>=0&&ty<curMap.h&&!curMap.d[ty*curMap.w+tx]){p.step=1}}function checkTile(){curMap.exits.forEach(e=>{if(p.x===e.x&&p.y===e.y){state="TRANSITION";setTimeout(()=>{curMap=MAPS[e.to];p.x=e.tx;p.y=e.ty;state=e.to},300)})});if(Math.random()<.05&&state==="TOWN")startBattle()}function startBattle(){state="BATTLE";text="Wild BOBO encountered! HP:20/20 Lv5";p.hp=20;p.maxHp=20;p.lvl=5;p.exp=0}function useItem(){if(state==="BATTLE"&&p.hp<p.maxHp){p.hp=Math.min(p.maxHp,p.hp+10);text="Potion used! HP:"+p.hp+"/"+p.maxHp}}function checkLab(){if(p.dir==0&&p.y>0&&curMap.d[(p.y-1)*curMap.w+p.x]===8)text="CHOOSE STARTER: A=BOBOSIRE B=HARMANDA"}function nextIntro(){introStep++;if(introStep===1)text="WELCOME TO MIRRORMON!";if(introStep===2)text="PRESS A TO BEGIN";if(introStep>=3){state="ROOM";text=""}}function draw(){c.clearRect(0,0,W,H);if(state==="INTRO"){c.fillStyle="#fff";c.font="16px monospace";c.fillText("MIRRORMON",100,100);c.font="10px monospace";c.fillText(text||"PRESS A",80,140);return}c.fillStyle="#0f1a2a";c.fillRect(0,0,W,H);let tw=16;for(let y=0;y<curMap.h;y++)for(let x=0;x<curMap.w;x++){let t=curMap.d[y*curMap.w+x];let dx=x*tw,dy=y*tw;c.fillStyle=t===1?"#0f1a2a":t===4?"#4a7a9a":"#5a8a7a";c.fillRect(dx,dy,tw,tw)}c.fillStyle="#f00";c.fillRect(p.x*tw,p.y*tw,tw,tw);if(text){c.fillStyle="#222";c.fillRect(10,H-50,W-20,40);c.fillStyle="#fff";c.font="10px monospace";c.fillText(text,20,H-30)}}let introStep=0;loop();</script></body></html>
