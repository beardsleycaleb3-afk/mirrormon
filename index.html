<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        body { background: #1a1a1a; margin: 0; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; }
        #mm-console { width: 95vw; height: 90vh; background: #333; border: 8px solid #222; border-radius: 40px; display: flex; flex-direction: column; padding: 15px; box-sizing: border-box; }
        #game-view { flex: 0.6; background: #000; border: 10px solid #111; position: relative; display: grid; grid-template-columns: repeat(16, 1fr); overflow: hidden; }
        .tile { width: 100%; height: 100%; }
        .wall { background: #822; }
        .path { background: #222; border: 0.1px solid #333; }
        #sultan { position: absolute; width: 6.25%; height: 6.25%; background: cyan; border-radius: 50%; box-shadow: 0 0 10px cyan; z-index: 99; transition: 0.1s; }
        #pad { flex: 0.4; display: flex; justify-content: space-around; align-items: center; }
        .btn { background: #222; border: 2px solid #666; color: #fff; width: 55px; height: 55px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 20px; }
    </style>
</head>
<body>

<div id="mm-console">
    <div id="game-view">
        <div id="sultan"></div>
    </div>
    <div id="pad">
        <div style="display: grid; grid-template-columns: repeat(3, 55px);">
            <div></div><div class="btn" onclick="move(0,-1)">▲</div><div></div>
            <div class="btn" onclick="move(-1,0)">◀</div><div></div><div class="btn" onclick="move(1,0)">▶</div>
            <div></div><div class="btn" onclick="move(0,1)">▼</div><div></div>
        </div>
        <div class="btn" style="border-radius: 50%; width: 70px; height: 70px; background: #a22;">A</div>
    </div>
</div>

<script src="town1map.js"></script>

<script>
    // This is the core engine logic
    let x = 4, y = 0;
    const view = document.getElementById('game-view');
    const hero = document.getElementById('sultan');

    function draw() {
        if (typeof town1Data === 'undefined') {
            view.innerHTML = "<div style='color:white; padding:20px;'>Error: town1map.js not found</div>";
            return;
        }
        view.innerHTML = '<div id="sultan"></div>'; 
        town1Data.forEach(row => {
            row.forEach(cell => {
                const t = document.createElement('div');
                t.className = 'tile ' + (cell === 1 ? 'wall' : 'path');
                view.appendChild(t);
            });
        });
        update();
    }

    function update() {
        const h = document.getElementById('sultan');
        h.style.left = (x * 6.25) + "%";
        h.style.top = (y * 6.25) + "%";
    }

    function move(dx, dy) {
        if(town1Data[y+dy] && town1Data[y+dy][x+dx] !== 1) {
            x += dx; y += dy;
            update();
        }
    }

    window.onload = draw;
</script>
</body>
</html>
